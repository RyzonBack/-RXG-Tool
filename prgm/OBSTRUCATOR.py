
import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCBiYXNlNjQKCm9iZnVzY2F0aW9uX2ZvbGRlciA9ICJvYnN0cnUiCgojIENyw6llIGxlIGRvc3NpZXIgb2JzdHJ1IHMnaWwgbidleGlzdGUgcGFzCmlmIG5vdCBvcy5wYXRoLmV4aXN0cyhvYmZ1c2NhdGlvbl9mb2xkZXIpOgogICAgb3MubWFrZWRpcnMob2JmdXNjYXRpb25fZm9sZGVyKQoKIyBOaXZlYXUgMzogRW5jb2RlIGVuIEJhc2U2NCBhdmVjIHVuIGTDqWNvZGV1ciBhdXRvbWF0aXF1ZQpkZWYgYWR2YW5jZWRfb2JmdXNjYXRpb24oZmlsZV9jb250ZW50KToKICAgIGVuY29kZWRfY29udGVudCA9IGJhc2U2NC5iNjRlbmNvZGUoZmlsZV9jb250ZW50LmVuY29kZSgndXRmLTgnKSkuZGVjb2RlKCd1dGYtOCcpCiAgICBvYmZ1c2NhdGVkX2NvbnRlbnQgPSBmIiIiCmltcG9ydCBiYXNlNjQKZXhlYyhiYXNlNjQuYjY0ZGVjb2RlKCd7ZW5jb2RlZF9jb250ZW50fScpLmRlY29kZSgndXRmLTgnKSkKIiIiCiAgICByZXR1cm4gb2JmdXNjYXRlZF9jb250ZW50CgojIEZvbmN0aW9uIHBvdXIgb2JmdXNxdWVyIHVuIGZpY2hpZXIKZGVmIG9iZnVzY2F0ZV9maWxlKGZpbGVfcGF0aCk6CiAgICB3aXRoIG9wZW4oZmlsZV9wYXRoLCAncicsIGVuY29kaW5nPSd1dGYtOCcsIGVycm9ycz0naWdub3JlJykgYXMgZjoKICAgICAgICBmaWxlX2NvbnRlbnQgPSBmLnJlYWQoKQoKICAgIG9iZnVzY2F0ZWRfY29udGVudCA9IGFkdmFuY2VkX29iZnVzY2F0aW9uKGZpbGVfY29udGVudCkKICAgIAogICAgZmlsZW5hbWUgPSBvcy5wYXRoLmJhc2VuYW1lKGZpbGVfcGF0aCkKICAgIG91dHB1dF9maWxlID0gb3MucGF0aC5qb2luKG9iZnVzY2F0aW9uX2ZvbGRlciwgZiJvYmZ1c2NhdGVkX3tmaWxlbmFtZX0iKQoKICAgIHdpdGggb3BlbihvdXRwdXRfZmlsZSwgJ3cnLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOgogICAgICAgIGYud3JpdGUob2JmdXNjYXRlZF9jb250ZW50KQogICAgCiAgICBwcmludChmIkZpY2hpZXIgb2JmdXNxdcOpIHNhdXZlZ2FyZMOpIHNvdXMgOiB7b3V0cHV0X2ZpbGV9IikKCiMgRm9uY3Rpb24gcG91ciBsaXN0ZXIgbGVzIGZpY2hpZXJzIGRhbnMgbGUgZG9zc2llciBvYnN0cnUvCmRlZiBsaXN0X2ZpbGVzKCk6CiAgICBmaWxlcyA9IG9zLmxpc3RkaXIob2JmdXNjYXRpb25fZm9sZGVyKQogICAgaWYgbm90IGZpbGVzOgogICAgICAgIHByaW50KCJBdWN1biBmaWNoaWVyIHRyb3V2w6kgZGFucyBsZSBkb3NzaWVyIG9ic3RydS8iKQogICAgICAgIHJldHVybiBbXQogICAgcHJpbnQoIlxuPT09PT0gRmljaGllcnMgZGFucyBvYnN0cnUvID09PT09IikKICAgIGZvciBpZHgsIGZpbGVuYW1lIGluIGVudW1lcmF0ZShmaWxlcyk6CiAgICAgICAgaWYgb3MucGF0aC5pc2ZpbGUob3MucGF0aC5qb2luKG9iZnVzY2F0aW9uX2ZvbGRlciwgZmlsZW5hbWUpKToKICAgICAgICAgICAgcHJpbnQoZiJ7aWR4ICsgMX0uIHtmaWxlbmFtZX0iKQogICAgcHJpbnQoIjQuIENoZW1pbiBzcMOpY2lmaXF1ZSIpCiAgICByZXR1cm4gZmlsZXMKCmRlZiBtYWluKCk6CiAgICBwcmludCgiPT09PT0gT0JTVFJVQ1RFVVIgPT09PT0iKQogICAgCiAgICBmaWxlcyA9IGxpc3RfZmlsZXMoKQogICAgaWYgbm90IGZpbGVzOgogICAgICAgIHJldHVybgoKICAgIHRyeToKICAgICAgICBjaG9pY2UgPSBpbnQoaW5wdXQoIlxuQ2hvaXNpc3NleiB1biBmaWNoaWVyIMOgIG9iZnVzcXVlciAoMS00KSA6ICIpKQogICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgcHJpbnQoIkVudHLDqWUgaW52YWxpZGUuIikKICAgICAgICByZXR1cm4KCiAgICBpZiBjaG9pY2UgPT0gNDoKICAgICAgICBmaWxlX3BhdGggPSBpbnB1dCgiRW50cmV6IGxlIGNoZW1pbiBzcMOpY2lmaXF1ZSBkdSBmaWNoaWVyIMOgIG9iZnVzcXVlciA6ICIpCiAgICAgICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKGZpbGVfcGF0aCk6CiAgICAgICAgICAgIHByaW50KCJFcnJldXIgOiBmaWNoaWVyIGludHJvdXZhYmxlLiIpCiAgICAgICAgICAgIHJldHVybgogICAgZWxzZToKICAgICAgICBpZiBjaG9pY2UgPCAxIG9yIGNob2ljZSA+IGxlbihmaWxlcyk6CiAgICAgICAgICAgIHByaW50KCJDaG9peCBpbnZhbGlkZS4iKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBmaWxlX3BhdGggPSBvcy5wYXRoLmpvaW4ob2JmdXNjYXRpb25fZm9sZGVyLCBmaWxlc1tjaG9pY2UgLSAxXSkKCiAgICBvYmZ1c2NhdGVfZmlsZShmaWxlX3BhdGgpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigp').decode('utf-8'))
